<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>Levels_Events</name>
    <events>
        <comment>On start of layout set HighestUnlockedLevel to SaveCompletedLevel from webstorage</comment>
        <event-block sid="6135501991645985">
            <conditions>
                <condition id="-2" name="On start of layout" sid="5140456130946976" type="System" />
            </conditions>
            <actions>
                <action id="-9" name="Set value" sid="1974754524804584" type="System">
                    <param id="0" name="Variable">HighestUnLockedLevel</param>
                    <param id="1" name="Value">int(WebStorage.LocalValue(&quot;SaveCompletedLevel&quot;))+1</param>
                </action>
            </actions>
            <sub-events>
                <comment>Set default global variables if playing for first time.</comment>
                <event-block sid="8734100661416313">
                    <conditions>
                        <condition id="3" inverted="1" name="Local key exists" sid="1659412047183497" type="WebStorage">
                            <param id="0" name="Key">&quot;SaveCompletedLevel&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-21" name="Reset global variables" sid="9261567218866716" type="System" />
                    </actions>
                </event-block>
            </sub-events>
        </event-block>
        <comment>Show the unlocked levels with opacity=100</comment>
        <event-block sid="3698757703736165">
            <conditions>
                <condition id="-2" name="On start of layout" sid="8091706862360805" type="System" />
            </conditions>
            <actions />
            <sub-events>
                <event-block sid="5289176653342466">
                    <conditions>
                        <condition id="-11" name="For Each" sid="5861100951976292" type="System">
                            <param id="0" name="Object">LevelsButton</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="777898479028915">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="9583323030526059" type="LevelsButton">
                                    <param id="0" name="Instance variable">LevelNumber</param>
                                    <param id="1" name="Comparison">3</param>
                                    <param id="2" name="Value">HighestUnLockedLevel</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-16" name="Set opacity" sid="6070299583334179" type="LevelsButton">
                                    <param id="0" name="Opacity">100</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-block>
        <comment>On touched Level which is unlocked go to the associated level and set CurrentLevel to corresponding level num</comment>
        <event-block sid="5218897266534125">
            <conditions>
                <condition id="3" name="On touched object" sid="9860818357947661" type="Touch">
                    <param id="0" name="Object">LevelsButton</param>
                </condition>
                <condition id="-8" name="Compare two values" sid="8923644450945477" type="System">
                    <param id="0" name="First value">LevelsButton.Opacity</param>
                    <param id="1" name="Comparison">0</param>
                    <param id="2" name="Second value">100</param>
                </condition>
            </conditions>
            <actions>
                <action id="-9" name="Set value" sid="8727065534057284" type="System">
                    <param id="0" name="Variable">CurrentLevel</param>
                    <param id="1" name="Value">LevelsButton.LevelNumber</param>
                </action>
                <action id="-25" name="Go to layout (by name)" sid="6100354587298398" type="System">
                    <param id="0" name="Layout">LevelsButton.MyLayout</param>
                </action>
            </actions>
        </event-block>
        <comment>On destination reached if the current level is Highest Unlocked Level Add 1 to HighestUnlockedLevel(i.e Unlocking the next Level) and update the completed levevls at webstorage</comment>
        <event-block sid="8298186249514316">
            <conditions>
                <condition id="0" name="On collision with another object" sid="4964548357042767" type="Dino">
                    <param id="0" name="Object">Win</param>
                </condition>
            </conditions>
            <actions />
            <sub-events>
                <event-block sid="7916678249659152">
                    <conditions>
                        <condition id="-8" name="Compare two values" sid="7007938315453203" type="System">
                            <param id="0" name="First value">CurrentLevel</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Second value">HighestUnLockedLevel</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-10" name="Add to" sid="2091181754063698" type="System">
                            <param id="0" name="Variable">HighestUnLockedLevel</param>
                            <param id="1" name="Value">1</param>
                        </action>
                        <action id="0" name="Set local value" sid="3297193103041815" type="WebStorage">
                            <param id="0" name="Key">&quot;SaveCompletedLevel&quot;</param>
                            <param id="1" name="Value">CurrentLevel</param>
                        </action>
                        <action id="-2" name="Go to layout" sid="9792500685077049" type="System">
                            <param id="0" name="Layout">LevelsScreen</param>
                        </action>
                    </actions>
                </event-block>
                <comment>If player is playing the levels which he already completed don&apos;t update the Highest unlocked level but goto next levevl on destination reached.</comment>
                <event-block sid="6181254362808201">
                    <conditions>
                        <condition id="-22" name="Else" sid="8383245435106758" type="System" />
                    </conditions>
                    <actions>
                        <action id="-25" name="Go to layout (by name)" sid="4832383351736134" type="System">
                            <param id="0" name="Layout">&quot;Stage&quot;&amp; (CurrentLevel+1)</param>
                        </action>
                        <action id="-10" name="Add to" sid="8552915926500117" type="System">
                            <param id="0" name="Variable">CurrentLevel</param>
                            <param id="1" name="Value">1</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-block>
        <comment>If Highest unlocked levels reached to total levels unlock all the levevels</comment>
        <event-block sid="9096670520237383">
            <conditions>
                <condition id="-8" name="Compare two values" sid="8927530046003619" type="System">
                    <param id="0" name="First value">HighestUnLockedLevel</param>
                    <param id="1" name="Comparison">5</param>
                    <param id="2" name="Second value">TotalLevels</param>
                </condition>
            </conditions>
            <actions>
                <action id="-9" name="Set value" sid="3777926029585482" type="System">
                    <param id="0" name="Variable">HighestUnLockedLevel</param>
                    <param id="1" name="Value">TotalLevels</param>
                </action>
                <action id="-16" name="Set opacity" sid="6490922077014722" type="LevelsButton">
                    <param id="0" name="Opacity">100</param>
                </action>
            </actions>
        </event-block>
    </events>
</c2eventsheet>
